openapi: 3.0.0
info:
  title: MNTRK API by MoStar Industries
  description: |
    This API provides robust tools for tracking Mastomys Natalensis populations, analyzing ecological trends, and supporting Lassa fever outbreak management. It is aligned with Nigeria CDC requirements and integrates with Supabase.
  version: 1.0.1
  contact:
    name: Mastomys Tracker Support Team
    email: support@mo-overlord.tech
    url: https://www.mo-overlord.tech/
servers:
  - description: SwaggerHub API Auto Mocking
    url: https://virtserver.swaggerhub.com/marv-b24/MNTRK/1.0.1
  - url: https://app.swaggerhub.com/apis/mostarindustries/MoStar_AI/1.0.1.2
    description: Production Server
  - url: https://staging.mo-overlord.tech/
    description: Staging Server
  - url: https://192.168.0.105:1234
    description: Local DeepSeek AI Server
security:
  - OAuth2: ['read:userfiles', 'data:read']
  - deepseekAuth: []
  - GoogleVisionKey: []
components:
  securitySchemes:
    OAuth2:
      type: oauth2
      flows:
        authorizationCode:
          authorizationUrl: https://login.microsoftonline.com/2e270476-4cbe-4c7f-b99a-8710d225bcc6/oauth2/v2.0/authorize
          tokenUrl: https://login.microsoftonline.com/2e270476-4cbe-4c7f-b99a-8710d225bcc6/oauth2/v2.0/token
          scopes:
            read:userfiles: Grants read access to user files
            write:userfiles: Grants write access to user files
            data:read: Grants read access to all data
            data:write: Grants write access to all data
    deepseekAuth:
      type: apiKey
      in: header
      name: Authorization
      description: >
        DeepSeek API authentication for local deployment. Use `Authorization: sk-xxxx` in the header.

    GoogleVisionKey:
      type: apiKey
      in: header
      name: X-Api-Key
      description: >
        Google Vision API authentication using `X-Api-Key` header.

  schemas:
    HabitatAnalysisRequest:
      type: object
      properties:
        satellite_data:
          type: string
          description: Base64 encoded satellite image
        environmental_data:
          type: object
          properties:
            temperature:
              type: number
            rainfall:
              type: number
            vegetation_index:
              type: number
        geographic_coordinates:
          type: object
          properties:
            latitude:
              type: number
            longitude:
              type: number
        analysis_parameters:
          type: object
          properties:
            vegetation_threshold:
              type: number
    HabitatAnalysisResponse:
      type: object
      properties:
        id:
          type: integer
        location:
          type: object
          properties:
            latitude:
              type: number
            longitude:
              type: number
        suitability_score:
          type: number
        analysis_timestamp:
          type: string
          format: date-time
          description: Precise timestamp when the analysis was performed
        temporal_pattern:
          type: object
          properties:
            frequency:
              type: string
              enum:
                - daily
                - weekly
                - monthly
            historical_trend:
              type: string
              enum:
                - increasing
                - stable
                - decreasing
        risk_factors:
          type: array
          maxItems: 50
          items:
            type: object
            properties:
              factor_type:
                type: string
                enum:
                  - climate
                  - human_activity
                  - predator_presence
              impact_score:
                type: number
                format: float
                description: Impact on habitat suitability (0-100)
        future_projections:
          type: array
          maxItems: 10
          items:
            type: object
            properties:
              timeframe:
                type: string
                enum:
                  - 30_days
                  - 90_days
                  - 1_year
              projected_population:
                type: integer
              confidence_interval:
                type: number
                format: float
    DetectionPattern:
      type: object
      properties:
        id:
          type: integer
        location:
          type: object
          properties:
            latitude:
              type: number
            longitude:
              type: number
        detection_timestamp:
          type: string
          format: date-time
          description: Precise timestamp when the detection occurred
        temporal_pattern:
          type: object
          properties:
            frequency:
              type: string
              enum:
                - daily
                - weekly
                - monthly
            historical_trend:
              type: string
              enum:
                - increasing
                - stable
                - decreasing
        biometric_data:
          $ref: '#/components/schemas/BiometricProfile'
    DetectionPatternResponse:
      type: object
      properties:
        id:
          type: integer
        location:
          type: object
          properties:
            latitude:
              type: number
            longitude:
              type: number
        detection_timestamp:
          type: string
          format: date-time
          description: Precise timestamp when the detection occurred
        biometric_data:
          $ref: '#/components/schemas/BiometricProfile'
        environmental_context:
          type: object
          properties:
            temperature:
              type: number
            humidity:
              type: number
            vegetation_density:
              type: number
    VisionAnalyzeRequest:
      type: object
      properties:
        image:
          type: string
        confidence_threshold:
          type: number
    VisionAnalyzeResponse:
      type: object
      properties:
        status:
          type: string
        detections:
          type: array
          items:
            type: object
            properties:
              bounding_box:
                type: object
              confidence:
                type: number
              classification:
                type: string
        extracted_features:
          type: object
          properties:
            ndvi_index:
              type: number
            water_body_ratio:
              type: number
            land_classification:
              type: array
              items:
                type: string
    RemoteSensingAugmentationRequest:
      type: object
      properties:
        dataset_url:
          type: string
        augmentation_type:
          type: string
    RemoteSensingAugmentationResponse:
      type: object
      properties:
        message:
          type: string
        results_url:
          type: string
    DataTransformationRequest:
      type: object
      properties:
        dataset_url:
          type: string
    DataTransformationResponse:
      type: object
      properties:
        message:
          type: string
    AnomalyDetectionRequest:
      type: object
      properties:
        input_file:
          type: string
        detection_method:
          type: string
    AnomalyDetectionResponse:
      type: object
      properties:
        message:
          type: string
        anomaly_results_url:
          type: string
    AdaptiveLearningRequest:
      type: object
      properties:
        model_type:
          type: string
          enum:
            - linear_regression
            - random_forest
            - lstm
            - xgboost
            - prophet
            - autoencoder
        training_parameters:
          type: object
          properties:
            learning_rate:
              type: number
            epochs:
              type: integer
            batch_size:
              type: integer
            validation_split:
              type: number
        feedback_loop_configuration:
          type: object
          properties:
            enable_auto_retraining:
              type: boolean
            performance_threshold:
              type: number
              description: Threshold below which model retraining is triggered
            feedback_collection_period:
              type: string
              description: Time period for collecting performance metrics
    AdaptiveLearningResponse:
      type: object
      properties:
        message:
          type: string
        model_id:
          type: string
          format: uuid
        training_status:
          type: string
          enum:
            - pending
            - in_progress
            - completed
            - failed
        performance_metrics:
          type: object
          properties:
            accuracy:
              type: number
            precision:
              type: number
            recall:
              type: number
            f1_score:
              type: number
        feedback_loop_status:
          type: object
          properties:
            is_active:
              type: boolean
            last_retraining:
              type: string
              format: date-time
            performance_trend:
              type: string
              enum:
                - improving
                - stable
                - declining
    MovementPredictionResponse:
      type: object
      properties:
        predictions:
          type: array
          items:
            type: object
            properties:
              latitude:
                type: number
              longitude:
                type: number
              confidence:
                type: number
    GoogleVisionRequest:
      type: object
      properties:
        image:
          type: string
          description: Base64-encoded image data
        features:
          type: array
          items:
            type: string
          description: Google Vision features to analyze (e.g., LABEL_DETECTION)
    GoogleVisionResponse:
      type: object
      properties:
        labels:
          type: array
          items:
            type: string
          description: Detected labels
        objects:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
              bounding_box:
                type: object
        text:
          type: string
          description: Detected text
    PredictiveModelRequest:
      type: object
      properties:
        model_type:
          type: string
          enum:
            - linear_regression
            - random_forest
            - lstm
            - xgboost
            - prophet
            - autoencoder
          description: The predictive model to use
        input_features:
          type: object
          properties:
            temperature:
              type: number
            rainfall:
              type: number
            vegetation_index:
              type: number
        adaptive_context:
          type: object
          properties:
            region_bias_profile:
              type: string
              description: Learned bias profiles for regions (e.g., rainfall + altitude patterns)
            seasonality_override:
              type: boolean
              description: If true, reweights seasonal baselines using real-time anomalies
            trend_tuning_factor:
              type: number
              description: Adjusts the learning rate in response to observed trends
        multi_source_features:
          type: object
          properties:
            sentinel_ndvi_7d_avg:
              type: number
            rainfall_sensor_last_3d:
              type: number
            known_outbreak_density:
              type: number
        output_type:
          type: string
          enum:
            - probability
            - forecast
          description: Type of prediction output
    PredictiveModelResponse:
      type: object
      properties:
        status:
          type: string
        predictions:
          type: array
          items:
            type: object
            properties:
              location:
                type: object
                properties:
                  latitude:
                    type: number
                  longitude:
                    type: number
              suitability_score:
                type: number
              forecast_data:
                type: object
              confidence_explanation:
                type: object
                properties:
                  shap_scores:
                    type: array
                    items:
                      type: object
                      properties:
                        feature:
                          type: string
                        importance:
                          type: number
                  decision_context:
                    type: string
                    description: Plaintext summary (e.g., "high vegetation & moderate rainfall drove high suitability")
        model_feedback:
          type: object
          properties:
            misclassification_rate:
              type: number
            retrain_triggered:
              type: boolean
            feedback_window:
              type: string
    LangChainRequest:
      type: object
      properties:
        prompt:
          type: string
          description: Input prompt for LangChain with Deepseek
        model:
          type: string
          enum:
            - deepseek-r1-distill-qwen-7b
          default: deepseek-r1-distill-qwen-7b
          description: DeepSeek model identifier for local deployment of lmstudio-community/DeepSeek-R1-Distill-Qwen-7B-GGUF (4.68 GB, Q4_K_M quantization, qwen2 architecture)
        temperature:
          type: number
          format: float
          minimum: 0
          maximum: 1
          default: 0.7
          description: Control randomness of outputs (0=deterministic, 1=creative)
        options:
          type: object
          description: Additional options for generating insights
    LangChainResponse:
      type: object
      properties:
        generated_text:
          type: string
          description: Text generated by LangChain
        metadata:
          type: object
          description: Metadata related to the generation process
    SupabaseQueryRequest:
      type: object
      properties:
        query:
          type: string
          description: SQL query to execute on Supabase
        parameters:
          type: object
          additionalProperties:
            type: string
          description: Parameters for the SQL query
    SupabaseQueryResponse:
      type: object
      properties:
        data:
          type: array
          items:
            type: object
          description: Query results
        metadata:
          type: object
          description: Query execution metadata
    PostgresQueryRequest:
      type: object
      properties:
        query:
          type: string
          description: SQL query to execute on Postgres
        parameters:
          type: object
          additionalProperties:
            type: string
          description: Parameters for the SQL query
    PostgresQueryResponse:
      type: object
      properties:
        data:
          type: array
          items:
            type: object
          description: Query results from Postgres
        metadata:
          type: object
          description: Query execution metadata
    # New ultra-futuristic schemas

    GeoCoordinate:
      type: object
      properties:
        latitude:
          type: number
          format: float
          description: Latitude coordinate
        longitude:
          type: number
          format: float
          description: Longitude coordinate
    BiometricProfile:
      type: object
      properties:
        species_confidence:
          type: number
          format: float
          description: Confidence that organism is Mastomys Natalensis (0-1)
        morphological_features:
          type: array
          maxItems: 50
          items:
            type: string
        size_metrics:
          type: object
          properties:
            length_mm:
              type: number
            weight_g:
              type: number
        genetic_markers:
          type: array
          maxItems: 50
          items:
            type: string
        genomic_predictive_score:
          type: number
          description: Predicted behavioral alignment from genetic markers (0-1)
        behavioral_patterns:
          type: object
          properties:
            activity_level:
              type: string
              enum:
                - low
                - medium
                - high
            movement_pattern:
              type: string
              enum:
                - linear
                - erratic
                - circular
            foraging_behavior:
              type: string
              enum:
                - solo
                - group
                - opportunistic
    ClusterAnalysisResult:
      type: object
      properties:
        clusters:
          type: array
          items:
            type: object
            properties:
              cluster_id:
                type: integer
              center:
                $ref: '#/components/schemas/GeoCoordinate'
              radius:
                type: number
              member_count:
                type: integer
              density:
                type: number
              risk_assessment:
                type: object
                properties:
                  outbreak_probability:
                    type: number
                    format: float
                    description: Probability of disease outbreak (0-1)
                  population_growth_rate:
                    type: number
                    description: Estimated weekly growth rate
    WeatherClimateData:
      type: object
      properties:
        temperature_data:
          type: array
          items:
            type: object
            properties:
              timestamp:
                type: string
                format: date-time
              temperature_c:
                type: number
              humidity_percent:
                type: number
        precipitation_data:
          type: array
          items:
            type: object
            properties:
              timestamp:
                type: string
                format: date-time
              amount_mm:
                type: number
              type:
                type: string
                enum:
                  - rain
                  - snow
                  - hail
                  - mixed
        rainfall_anomaly:
          type: number
          description: Deviation from historical average
        climate_trends:
          type: object
          properties:
            seasonal_shift:
              type: string
              enum:
                - earlier
                - normal
                - later
            temperature_trend:
              type: string
              enum:
                - warming
                - stable
                - cooling
    NotificationSubscription:
      type: object
      properties:
        subscription_id:
          type: string
          format: uuid
        status:
          type: string
          enum:
            - active
            - paused
            - expired
        created_at:
          type: string
          format: date-time
        expiration_date:
          type: string
          format: date-time
paths:
  /api/habitats:
    post:
      summary: Analyze satellite or environmental data for Mastomys Natalensis habitats
      operationId: analyzeHabitats
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/HabitatAnalysisRequest'
      responses:
        '200':
          description: Habitat analysis successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HabitatAnalysisResponse'
        '400':
          description: Bad request
        '500':
          description: Internal server error
  /api/detection-patterns:
    post:
      summary: Record detection patterns of Mastomys Natalensis
      operationId: recordDetectionPatterns
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DetectionPattern'
      responses:
        '200':
          description: Detection recorded successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DetectionPatternResponse'
        '400':
          description: Bad request
        '500':
          description: Internal server error
  /api/vision/analyze:
    post:
      summary: Analyze images for Mastomys Natalensis
      operationId: analyzeVision
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VisionAnalyzeRequest'
      responses:
        '200':
          description: Image analysis successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VisionAnalyzeResponse'
        '400':
          description: Bad request
        '500':
          description: Internal server error
  /api/augmentation/remote-sensing:
    post:
      summary: Apply augmentation to remote sensing data
      operationId: applyAugmentation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RemoteSensingAugmentationRequest'
      responses:
        '200':
          description: Augmentation applied successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RemoteSensingAugmentationResponse'
        '400':
          description: Bad request
        '500':
          description: Internal server error
  /api/data-transformation:
    post:
      summary: Transform and clean datasets
      operationId: transformData
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DataTransformationRequest'
      responses:
        '200':
          description: Data transformation successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DataTransformationResponse'
        '400':
          description: Bad request
        '500':
          description: Internal server error
  /api/anomaly-detection:
    post:
      summary: Detect anomalies in data
      operationId: detectAnomalies
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AnomalyDetectionRequest'
      responses:
        '200':
          description: Anomalies detected successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnomalyDetectionResponse'
        '400':
          description: Bad request
        '500':
          description: Internal server error
  /api/adaptive-learning:
    post:
      summary: Configure adaptive learning
      operationId: configureAdaptiveLearning
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AdaptiveLearningRequest'
      responses:
        '200':
          description: Adaptive learning configured successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdaptiveLearningResponse'
        '400':
          description: Bad request
        '500':
          description: Internal server error
  /api/predict-movements:
    get:
      summary: Predict Mastomys movements
      operationId: predictMovements
      parameters:
        - name: latitude
          in: query
          required: true
          schema:
            type: number
        - name: longitude
          in: query
          required: true
          schema:
            type: number
        - name: date
          in: query
          required: true
          schema:
            type: string
            format: date
      responses:
        '200':
          description: Movements predicted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MovementPredictionResponse'
        '400':
          description: Bad request
        '500':
          description: Internal server error
  /api/integration/vision/google-vision:
    post:
      summary: Integrate with Google Vision API
      operationId: integrateGoogleVision
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GoogleVisionRequest'
      responses:
        '200':
          description: Google Vision integration successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleVisionResponse'
        '400':
          description: Bad request
        '500':
          description: Internal server error
  /api/modeling/predictive:
    post:
      summary: Execute predictive modeling
      operationId: predictiveModeling
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PredictiveModelRequest'
      responses:
        '200':
          description: Predictive modeling executed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PredictiveModelResponse'
        '400':
          description: Bad request
        '500':
          description: Internal server error
  /api/langchain/generate:
    post:
      summary: Generate AI insights using LangChain with DeepSeek-R1-Distill-Qwen-7B
      operationId: generateLangChainInsights
      security:
        - deepseekAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LangChainRequest'
      responses:
        '200':
          description: Insights generated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LangChainResponse'
        '400':
          description: Bad request
        '500':
          description: Internal server error
  /api/integration/supabase/query:
    post:
      summary: Query data from Supabase
      operationId: querySupabaseData
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SupabaseQueryRequest'
      responses:
        '200':
          description: Query executed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SupabaseQueryResponse'
        '400':
          description: Bad request
        '500':
          description: Internal server error
  /api/integration/postgres/query:
    post:
      summary: Query data from Postgres database
      operationId: queryPostgresData
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PostgresQueryRequest'
      responses:
        '200':
          description: Query executed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PostgresQueryResponse'
        '400':
          description: Bad request
        '500':
          description: Internal server error
  # New ultra-futuristic endpoints

  /api/spatial/clustering:
    post:
      summary: Analyze spatial clustering of detection patterns
      operationId: analyzeSpatialClustering
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                region_coordinates:
                  type: array
                  items:
                    $ref: '#/components/schemas/GeoCoordinate'
                timeframe:
                  type: string
                  format: date-range
                clustering_algorithm:
                  type: string
                  enum:
                    - DBSCAN
                    - HDBSCAN
                    - K-means
                min_points:
                  type: integer
                  description: Minimum points to form a cluster
                epsilon:
                  type: number
                  description: Maximum distance between points in a cluster
      responses:
        '200':
          description: Clustering analysis completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClusterAnalysisResult'
        '400':
          description: Bad request
        '500':
          description: Internal server error
  /api/integration/weather-climate:
    get:
      summary: Retrieve weather and climate data for habitat analysis
      operationId: getWeatherClimateData
      parameters:
        - name: latitude
          in: query
          required: true
          schema:
            type: number
        - name: longitude
          in: query
          required: true
          schema:
            type: number
        - name: timeframe
          in: query
          required: true
          schema:
            type: string
            enum:
              - current
              - 7_day_forecast
              - historical_30_days
              - seasonal_projection
      responses:
        '200':
          description: Weather and climate data retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeatherClimateData'
        '400':
          description: Bad request
        '500':
          description: Internal server error
  /api/notifications/subscribe:
    post:
      summary: Subscribe to real-time notifications for detection events
      operationId: subscribeToNotifications
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                notification_type:
                  type: string
                  enum:
                    - new_detection
                    - threshold_breach
                    - habitat_change
                    - outbreak_risk
                region:
                  type: object
                  properties:
                    center:
                      $ref: '#/components/schemas/GeoCoordinate'
                    radius_km:
                      type: number
                threshold_parameters:
                  type: object
                  properties:
                    population_density:
                      type: number
                    suitability_score:
                      type: number
                    movement_rate:
                      type: number
                smart_thresholds:
                  type: object
                  properties:
                    auto_calibrated:
                      type: boolean
                    recent_anomaly_window:
                      type: string
                      description: Time window for dynamic threshold recalibration (e.g., "7d")
                delivery_channel:
                  type: string
                  enum:
                    - webhook
                    - email
                    - sms
                    - push_notification
                delivery_target:
                  type: string
                expiration_days:
                  type: integer
                  description: Number of days until subscription expires
      responses:
        '200':
          description: Subscription successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationSubscription'
        '400':
          description: Bad request
        '500':
          description: Internal server error
  /api/temporal-analysis:
    post:
      summary: Analyze temporal patterns in detection data
      operationId: analyzeTemporalPatterns
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                start_date:
                  type: string
                  format: date
                end_date:
                  type: string
                  format: date
                region_coordinates:
                  type: array
                  items:
                    $ref: '#/components/schemas/GeoCoordinate'
                temporal_resolution:
                  type: string
                  enum:
                    - hourly
                    - daily
                    - weekly
                    - monthly
                analysis_type:
                  type: string
                  enum:
                    - trend
                    - seasonality
                    - anomaly
                    - forecast
      responses:
        '200':
          description: Temporal analysis completed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  analysis_id:
                    type: string
                  analysis_type:
                    type: string
                  trends:
                    type: array
                    items:
                      type: object
                  seasonality:
                    type: object
                  anomalies:
                    type: array
                    items:
                      type: object
                  forecasts:
                    type: array
                    items:
                      type: object
        '400':
          description: Bad request
        '500':
          description: Internal server error
